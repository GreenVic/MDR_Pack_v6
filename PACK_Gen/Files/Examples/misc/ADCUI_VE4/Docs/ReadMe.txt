В данных файлах представлены данные измерений Сигма-Дельта АЦП дифференциального сигнала.

Для этого в МК сохранялся буфер последовательных значений от АЦП, который затем по UART передавался в РС.


============	ADCUI.xlsx ЛИСТ1   ===========
Представлены данные из МК при изменении входного сигнала на 0,2В. Данные выведены парами в десятичной системе и шестнадцатеричной, например:

INM2 INP2
1,6   1,6		- Напряжения на входах равны синфазному, т.е. сигнал нулевой
212   0xd4		- Данные от АЦП болтаются около нуля.
364   0x16c
-581  0xfffffdbb	- Данные знаковые!
754   0x2f2
792   0x318
-193  0xffffff3f
-235  0xffffff15
216   0xd8
178   0xb2
-231  0xffffff19

АЦП измеряет 24-бита, это значение в дополнительном коде. Т.е. 23-й бит определяет знак. Для расширения данного числа до 32-го значения, родного для МК, использовано такое преобразование:

#define MDR_ADCUI_SIGN_OFFS     8

__STATIC_INLINE int32_t MDR_ADCUI_ReadData(MDR_ADCUI_CH ch) 
{ 
  volatile uint32_t result = MDR_ADCUI->DAT[(uint32_t)ch] << MDR_ADCUI_SIGN_OFFS;
  return (int32_t)(result) >> MDR_ADCUI_SIGN_OFFS;
}

Чтобы избавиться от данного расширения и вернуться к данным полученным в 24-разрядном коде достаточно сбросить самые старший байт, т.е. например 0xfffffdbb с АЦП пришло как 0x00fffdbb.

В файле UartLog_Step_0v1.txt непосредственно данные от UART с программы Terminal.


============	ADCUI.xlsx ЛИСТ2   ===========
Данные полученные в Листе 1 подразумеваются полученными от черного ящика. Проверим на сколько они согласуются с приведением к линейной зависимости.

Данные из Листа1 в десятичной системе представлены в виде таблице и по ним вычислено среднее значение АЦП для каждого шага входного сигнала. Потом посчитаны приращения от средних значений на шаг входного сигнала. Значения проказывают что на линейное измнение входного напряжения, отсчеты от АЦП изменяются так-же линейно. Коэффициент пропорциональности различается незначительно, высчитываем его среднее значение DATA/1V. Строим два графика:
1 - Зависимость данных Average от UDiff
2 - Второй по формуле DATA = -1783643 * UDiff, где -1783643 полученный из данных коэффициент пропорциональности.

Графики совпадают, что говорит о том, что 
1 - Данные от АЦП имеют линейную зависимость (что ожидаемо от АЦП).
2 - Расширение знака с 24-х до 32-х бит работает правильно.
3 - Форумла пересчета из спецификации не верна, слагаемое 2^23 лишнее.

FDAT=1/(2*UREF)*UIN*ANGAIN*DIGGAIN*2^22 + 2^23	- НЕПРАВИЛЬНО
FDAT=1/(2*UREF)*UIN*ANGAIN*DIGGAIN*2^22		- ПРАВИЛЬНО!

При измерениях ANGAIN=DIGGAIN=1, а URef = 1,2, что дает рассчетную формулу со схожим процентом пропорциональности:

	FDAT=1/(2*1,2)*2^22 * UIN = 1747626,(6)*UIN. 

Знак определяется тем как считать UIN, это INM2-INP2, или INP2-INM2.


============	ADCUI_4MHz.xlsx   ===========
Оказалось что пердыдущие измерения были сделаны на повышенной частоте. Поэтому данные были измерены заново, тактовая на АЦП подана 4МГц, частота сэмплирования получается 2МГц.

Выполнена подобная же линеаризация, но теперь еще и с перебором всех усилений х1, х2, х4, х16. Результаты представлены на графиках. Усиления дают зашкал сигнала, который хорошо заметен на графиках.

Результаты показывают правильность формулы с учетом аналоговых усилений:

FDAT=1/(2*1,2)*ANGAIN*2^22 * UIN

В спецификации введен запрет на любые значения цифрового усиления, кроме DIGGAIN=1. Поэтому данное усиление не проверялось.


============	ADCUI_SFC.xlsx   ===========
В данном файле представлены отсчеты полученные при подаче сигнала в виде синуса произвольной амплитуда и частоты. Проверено визуально что отрабатывает переключение делителя SFC.


============	ADCUI_VE4_Sin.xlsx   ===========
В данном файле представлены отсчеты полученные при подаче сигнала в виде синуса, осциллограмма входного сигнала на картинке ADCUI_VE4_Sin.png.

Данные с АЦП соответствуют амплитуде сигнала, что так-же подтверждает формулу.



