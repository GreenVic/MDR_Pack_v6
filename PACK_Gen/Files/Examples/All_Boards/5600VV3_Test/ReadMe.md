# Пример работы с микросхемой коммутатора 5600ВВ3Т через 1986ВЕ1Т

Проект проверяет работу драйвера управления 5600ВВ3Т по SPI - чтение/запись регистров и чтение/запись МАС таблицы.

Действия по кнокпам:
  * UP - вывести значения регистров микросхемы в UART
  * RIGHT - записать биты FullDuplex для 5-го порта MII и выключить удаление записей в таблице МАС при достижении счетчиком старения максимального значения.
  * DOWN - вывод в UART все активные записи таблицы маршрутизации
  * LEFT - записать в таблицу маршрутизации две записи 
  * BACK - вывести в UART не нулевые записи таблицы маршрутизации

При тестировании выполнялись такие действия (см. Log.txt):
  * UP - посмотреть начальные значения регистров микросхемы (после подачи питания)
  * RIGHT - записть в регистры для изменения настроек старения и FullDuplex
  * UP - провертить что регистры изменили значения
  * DOWN - считать таблицу, убедиться что таблица пустая
  * LEFT - запись двух записей в таблицу
  * DOWN - считать таблицу, проверить что две записи появились. Иногда записи появляются не с первой раза.
  * Подключиться к сети, нажимая DOWN, убедиться что таблица маршрутизации обновляется.

## Notes
  * Чтобы SPI работал стабильно разъем подключения SPI на 5600ВВ3Т пришлось поджимать пальцем. Иначе обмен был не стабильный и 5600ВВ3 переставала правильно отвечать по SPI (Чтение регистров читалось по разному, уходило в разнос). 
  * При запуске с тестером "Беркут-ЕТ" таблица маршрутизации обновляется после того как тестер переходит на обмен пакетами превышающими 64 байта. Причина описана в еррате - коммутатор не успевает обновить таблицу при длине пакета меньше ~70 байт.
  * Пины подключались согласно картинкам из данной статьи - https://startmilandr.ru/doku.php/prog:spi:ve1_5600vv3 . Режим работы коммутатора MODE = 1111. Для запуска с другим микроконтроллером в main.c необходимо переопределить пины используемого SPI.
  * Дополнительная информация - https://startmilandr.ru/doku.php/doc:interf:5600bb3t