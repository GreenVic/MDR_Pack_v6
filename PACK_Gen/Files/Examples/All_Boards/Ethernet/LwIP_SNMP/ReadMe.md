# Пример работы протокола SNMP через стек LwIP

Пример для отладочной платы 1986ВЕ1Т.

Внутри микроконтроллеа, в локальной базе MIB реализованы OID для отображения состояния кнопки UP и переключения светодиода VD6. Для управления использовалась программа "iReasoning MIB Browser". OID для управления периферией забиваются непосредственно в поле OID, т.к. mib файла с enterprise веткой пока нет. В закладке Advanced указываются имена сообществ "public" и "private" для доступа по чтению и для чения-записи соответственно. SNMP Version выставить в 2. Необходимо так-же указать IP, который в данном примере прописан статически в lwipopts.h.

## Отображение состояния кнопки
.1.3.6.1.4.1.26381.1.2.0 - OID для чтения кнопки, выбирается функция Get и наживается GO. При нажатом состоянии кнопки чтение OID возвращает 1, при отжатом 0.

## Переключение светодиода
.1.3.6.1.4.1.26381.1.1.0 - OID для доступа к светодиоду. Функция Get - для отображения состояния светодиода (1 - включен). Для переключения светодиода выбрать функцию Set и нажать GO. Откроется окно, в котором необходимо выбрать тип Integer и значение для светодиода: 1 - зажечь, 0 - выключить.

## MIB files (update)
Для работы с OID светодиода и кнопки был написан MIB файл, точнее два - LWIP_MIB (базовый) и MIL_IO_MIB.txt (с объектами кнопка и светодиод). Файлы необходимо скопировать в директорию где iReasoning хранит свои MIB файлы. Затем файл MIL_IO_MIB.txt необходимо загрузить в iReasoning, тогда к стандартной ветке добавится ветка с LWIP (LWIP_MIB подключится по ссылке из MIL_IO_MIB.txt) и в ней будет ветка с управлением светодиодом и кнопкой. См. картинки:

  * MIB_IO_Ctrl.png - Управление светодиодом и чтение кнопки UP (в коде это user_MIB)
  * MIB_System.png - Чтение системной информации (в коде это mib2)

Двойной клик на параметре в дереве производит чтение и вывод считанного значения. Запись параметра можно сделать командой Set, которая доступна по правой кнопке мыши.

## СПАСИБО!
В качестве примера кода использовалась данная статья: http://microelk.azurewebsites.net/LWIP_SNMP_agent/LWIP_SNMP_agent. Автору ОГРОМНОЕ спасибо, поскольку информации и примеров по snmp действительно немного.

MID файлы реализован по данной статье: https://www.ibm.com/developerworks/ru/library/snmp_essentials_02/index.html . Так-же большое спасибо автору! Это единственное внятное описание которое помогло.
