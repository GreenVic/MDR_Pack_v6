# Пример работы DMA с SPI на передачу и прием данных.

DMA работает в основном режиме, используются только основные структуры каналов.
   TX - Один канал DMA настроен на обработку запросов от SPI по наличию пустого места в FIFO передатчика.
   RX - Еще один канал DMA настроен на обработку запросов от SPI по наличию данных в FIFO приемника.

По нажатию на кнопку Up (Key1) запускается цикл передачи данных:
   - Загораются два светодиода (LED_CYCLIC, LED_ERR), показывая начало цикла DMA.
   - Канал DMA_TX копирует данные из массива в регистр DR передатчика SPI, по мере появления пустого места в FIFO передатчика.
   - Передатчик передает данные по линии, которые получает приемник SPI в свой регистр DR.
   - SPI по приему слова выставляет запрос к DMA_RX, который копирует данные в массив принятых данных.
   - Данные сравниваются. Если данные не совпали, то второй светодиод (LED_ERR) остается включенным, показывая ошибку. Если данные совпали то LED_ERR выключается. Светодиод LED_CYCLIC вне обработчика кнопки UP постоянно мигает, показывая что исполнение не зависло в обработчике прерывания DMA.

В микроконтроллерах и на демоплатах, где доступен только один SPI, данные передаются самому себе. Для передачи данных достаточно замкнуть контакты RX и TX на плате, остальные сигналы SPI не нужны.
Там, где доступно два SPI данные передаются между разными SPI, но возможен запуск и для одного SPI - необходимо лишь немного поправить код. Чтобы данные передавались необходимо подключить все сигналы SPI.
Если сигналы не подключать, то светодиод LED_ERR остается гореть, показывая что передачи не было.